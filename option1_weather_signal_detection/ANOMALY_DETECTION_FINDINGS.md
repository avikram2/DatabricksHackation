# Anomaly Detection Findings
Generated by: Option 1 — Notebook 04 (Anomaly Detection & Explanation)
Date generated: 2026-02-28 17:03

This report summarises the three-layer yield anomaly detection results for Corn
and Soybeans across US counties (2010–2024).

**Detection layers:**
- Layer 1 (Z-score): statistically unusual yield for that county's own history
- Layer 2 (XGBoost residual): yield below what weather features predict
- Layer 3 (Isolation Forest on residuals): non-linear unexplained structure

## Overall Statistics
- Total county-year observations: 30,649
- Total flagged as anomalous (any layer): 8,914 (29.1%)

**Anomaly type breakdown:**
  - WEATHER_DRIVEN: 5,584 (62.6%)  ← yield low AND bad weather — model confirms weather drove the loss
  - UNEXPLAINED: 1,325 (14.9%)  ← yield low AND weather normal — investigate non-meteorological causes
  - ISOLATION_ONLY: 1,237 (13.9%)  ← unusual feature combination flagged by Isolation Forest
  - RESIDUAL_ONLY: 768 (8.6%)  ← absolute yield OK but model expected more given conditions

## Per-Crop Summary
### Corn
- Total anomalies: 4,429
  - WEATHER_DRIVEN: 2,741
  - UNEXPLAINED: 679
  - ISOLATION_ONLY: 636
  - RESIDUAL_ONLY: 373

**Top 5 most extreme UNEXPLAINED events — Corn** (largest negative residual):
  - 2024 | Horry, SC: actual=35.3, predicted=165.0, residual=-129.7 bu/ac
  - 2016 | Fulton, PA: actual=60.2, predicted=171.8, residual=-111.6 bu/ac
  - 2023 | Crow Wing, MN: actual=49.2, predicted=155.1, residual=-105.9 bu/ac
  - 2010 | Franklin, VA: actual=27.4, predicted=133.2, residual=-105.8 bu/ac
  - 2015 | Gasconade, MO: actual=61.8, predicted=166.9, residual=-105.1 bu/ac

### Soybeans
- Total anomalies: 4,485
  - WEATHER_DRIVEN: 2,843
  - UNEXPLAINED: 646
  - ISOLATION_ONLY: 601
  - RESIDUAL_ONLY: 395

**Top 5 most extreme UNEXPLAINED events — Soybeans** (largest negative residual):
  - 2023 | Elk, KS: actual=4.5, predicted=35.1, residual=-30.6 bu/ac
  - 2013 | Lunenburg, VA: actual=21.6, predicted=50.9, residual=-29.3 bu/ac
  - 2023 | Clay, NE: actual=15.2, predicted=41.9, residual=-26.7 bu/ac
  - 2010 | Washington, MD: actual=9.5, predicted=36.1, residual=-26.6 bu/ac
  - 2013 | Shelby, MO: actual=25.1, predicted=51.6, residual=-26.5 bu/ac

## Year-by-Year Anomaly Counts
Total anomalies per year (all crops combined). Known extreme events flagged.

  - 2010: 674 anomalies (UNEXPLAINED=138, WEATHER_DRIVEN=409, RESIDUAL_ONLY=96, ISOLATION_ONLY=31)
  - 2011: 816 anomalies (UNEXPLAINED=126, WEATHER_DRIVEN=641, RESIDUAL_ONLY=27, ISOLATION_ONLY=22)
  - 2012: 1277 anomalies (UNEXPLAINED=191, WEATHER_DRIVEN=1044, RESIDUAL_ONLY=11, ISOLATION_ONLY=31)  ← **Great Plains Drought**
  - 2013: 694 anomalies (UNEXPLAINED=230, WEATHER_DRIVEN=269, RESIDUAL_ONLY=135, ISOLATION_ONLY=60)
  - 2014: 444 anomalies (UNEXPLAINED=62, WEATHER_DRIVEN=271, RESIDUAL_ONLY=75, ISOLATION_ONLY=36)
  - 2015: 387 anomalies (UNEXPLAINED=107, WEATHER_DRIVEN=158, RESIDUAL_ONLY=70, ISOLATION_ONLY=52)
  - 2016: 475 anomalies (UNEXPLAINED=49, WEATHER_DRIVEN=344, RESIDUAL_ONLY=14, ISOLATION_ONLY=68)
  - 2017: 285 anomalies (UNEXPLAINED=24, WEATHER_DRIVEN=171, RESIDUAL_ONLY=26, ISOLATION_ONLY=64)
  - 2018: 370 anomalies (UNEXPLAINED=42, WEATHER_DRIVEN=237, RESIDUAL_ONLY=24, ISOLATION_ONLY=67)
  - 2019: 333 anomalies (UNEXPLAINED=54, WEATHER_DRIVEN=199, RESIDUAL_ONLY=35, ISOLATION_ONLY=45)  ← **Wet Spring / Prevent Plant**
  - 2020: 332 anomalies (UNEXPLAINED=36, WEATHER_DRIVEN=170, RESIDUAL_ONLY=64, ISOLATION_ONLY=62)
  - 2021: 645 anomalies (UNEXPLAINED=30, WEATHER_DRIVEN=486, RESIDUAL_ONLY=23, ISOLATION_ONLY=106)  ← **Western Drought / Heat Dome**
  - 2022: 643 anomalies (UNEXPLAINED=48, WEATHER_DRIVEN=445, RESIDUAL_ONLY=10, ISOLATION_ONLY=140)  ← **Southern Heat Wave**
  - 2023: 803 anomalies (UNEXPLAINED=89, WEATHER_DRIVEN=415, RESIDUAL_ONLY=62, ISOLATION_ONLY=237)  ← **Mixed conditions**
  - 2024: 736 anomalies (UNEXPLAINED=99, WEATHER_DRIVEN=325, RESIDUAL_ONLY=96, ISOLATION_ONLY=216)

## 2012 Drought Deep-Dive (Model Validation)

The 2012 Great Plains Drought is the canonical model validation test.
If XGBoost residuals are near zero in 2012, the model correctly captured
drought signals in weather features — confirming the pipeline is working.

**Corn — 2012:**
  - Median actual yield:    101.9 bu/ac
  - Median predicted yield: 113.0 bu/ac
  - Median residual:        -6.7 bu/ac
  ✓ Small residual → model anticipated drought-driven losses from weather features.
    Most 2012 low yields are WEATHER_DRIVEN, not UNEXPLAINED.

**Soybeans — 2012:**
  - Median actual yield:    39.4 bu/ac
  - Median predicted yield: 38.6 bu/ac
  - Median residual:        0.8 bu/ac
  ✓ Small residual → model anticipated drought-driven losses from weather features.
    Most 2012 low yields are WEATHER_DRIVEN, not UNEXPLAINED.

## Key Findings

1. **WEATHER_DRIVEN anomalies confirm model validity**: Low yields in 2012 (Great
   Plains Drought), 2021 (Western Drought/Heat Dome), and 2022 (Southern Heat Wave)
   are predominantly WEATHER_DRIVEN — the model correctly anticipated the losses.

2. **UNEXPLAINED anomalies are the most actionable**: Counties flagged UNEXPLAINED
   underperformed despite normal or favourable weather. Likely causes: pest/disease
   outbreaks, irrigation failures, management errors, or data reporting issues.

3. **RESIDUAL_ONLY anomalies reveal hidden resilience**: Counties achieving normal
   yields despite adverse conditions may indicate irrigation advantages,
   drought-tolerant varieties, or superior farm management.

4. **2019 Prevent Plant signature**: UNEXPLAINED anomalies spike in 2019 because
   excess spring moisture prevented planting entirely — a discrete event the
   continuous weather features only partially capture.

## Methodology

- Data: USDA RMA county-level yields, Corn + Soybeans, 2010–2024, 32 states
- Weather: NOAA GHCN-Daily (temperature, precipitation, GDD, heat stress days)
- Layer 1: Leave-one-out robust Z-score, threshold |Z| > 1.5
- Layer 2: XGBoost residual (actual − predicted), threshold residual-Z < −1.5
- Layer 3: Isolation Forest on residuals, contamination = 0.08
- SHAP: TreeExplainer provides per-feature attribution for every flagged event
- Classification: UNEXPLAINED (Z∧residual), WEATHER_DRIVEN (Z only),
  RESIDUAL_ONLY (residual only), ISOLATION_ONLY (IF only)
